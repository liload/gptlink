# 常见问题

## 微信系列
### 微信扫码登录提示 AppID 参数错误

需要前往管理后台配置上网站应用的 `APPID` 与 `SECRET` ，网站应用申请 [点击前往](https://open.weixin.qq.com/)

网页授权域名校验文件放置容器内 `/app/gptweb` 目录下即可完成验证。

### 微信登陆提示 redirect_uri 与后台配置不一致

需要前往[微信公众平台](https://mp.weixin.qq.com/)配置网页回调域名为你的域名。

公众号菜单路径：设置与开发 -> 公众号设置 -> 功能设置 -> 网页授权域名。

网页授权域名校验文件放置容器内 `/app/gptweb` 目录下即可完成验证。

### 微信扫码提示 Scope参数错误或没有Scope权限

检查是否将公众号 AppId 与 Secret 配置在微信网站应用配置项中。微信网站应用 应前往开放平台申请。

### 微信支付成功但订单显示未支付

检查环境变量 `APP_URL` 是否正确，如不匹配微信回调通知将无法成功，通常配置为 协议 + 域名 + /api/，以下为示例

```txt
示例配置

APP_URL=https://abc.com/api/
...
```

### 点击微信支付提示服务器错误

将服务器 IP 添加至微信支付 IP 白名单内。

### 任务分享成功，无法获得次数

请检查微信公众号的 IP 白名单是否正确，分享依赖微信 Jssdk 配置，如未配置微信相关服务，建议关闭此任务。

### 微信支付 APPID 与 公众号 APPID 是否可以不同

不可以，JSAPI 支付需要依赖登陆时的用户 `OPENID`。

## 运维相关

### Docker 部署时提示服务器错误

1. 检查数据库与 Redis 配置地址是否可正常访问；
2. 确保 Mysql 版本大于等于5.7；
3. 可以通过命令 `docker logs gptlink` 查看容器运行是否产生异常；

PS : 不要填写 `127.0.0.1` 或 `localhost`，此地址是指向容器内，容器内并不包含 `Mysql` 和 `Redis` 服务，可以填写本机的内网 IP 如 `192.168.1.100` 或 容器的网关 IP。

### Docker-compose 首次运行提示服务器错误

`gptlink` 容器启动时，需要确保 `mysql` `redis` 等服务已启动完成，可通过 `docker-compose logs gptlink`命令查看运行时是否产生异常。

### 如何查看服务日志

1. 异常日志与调用日志

`docker-compose` 方式启动的项目，可以在 `docker-compose/data/logs` 目录中查看异常日志。如为 `Docker`方式运行，
可查看 `/app/gptserver/runtime/logs` 目录中的日志内容，或将此目录与宿主机共享。

2. 运行时的日志

可通过 `docker-compose logs gptlink` 或 `docker` 部署时使用 `docker logs gptlink` 查看运行日志。

### 数据表没有成功创建

通过容器运行时的日志查看运行失败原因，处理后重新运行容器。或可以在容器内通过  `php /app/gptserver/hyperf migrate` 命令完成数据表结构的迁移。

## 其他
### 用户登录方式切换后原账号无法使用
暂不支持 用户名/密码 与 微信登录方式并存

### 如何配置使用 OpenAI 提供的接口
1. 管理后台系统配置中，需要将密钥类型选为 `openai`
2. 如需使用第三方或自建代理地址，env 中需要填写 `OPENAI_HOST`， `OPENAI_PORT` 等配置

**注意事项：**

1. 配置前，请确保你配置的访问的站点是可用的，可先使用其他工具先行进行调试，如 `Postman`；
2. 提供服务的站点需要支持 `http2` 以及开启流传输，如使用 `OPENAI_PROXY_HOST`，`OPENAI_PROXY_PORT` 代理形式需要支持 `socket5` 协议；
3. 对话返回 `好像出错了，请稍后再试。`，`您中断了回答，诺继续请刷新重试` 请检查管理后台系统配置选项是否正确，以及检查请求的地址是否符合以上条件；
4. 对话返回的内容不完全，请联系提供服务的第三方运营商；

以上问题产生的错误不进行支持与反馈，请自行解决。

### 使用 CDN 后用户端数据返回异常

可能因 CDN 将 api 的部分也进行了缓存，配置 CDN 时需要将 `api/*` 路由排除，使接口部分路由进行回源。

### 项目中未见包含前端源码

前端源码会陆续开源，开源的版本为更高代码质量的版本。可访问下列仓库访问。

- [用户端](https://github.com/gptlink/gptlink-web)
- 管理端
- 用户端
