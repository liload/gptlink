var e=Object.defineProperty,a=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(a,o,l)=>o in a?e(a,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[o]=l,s=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&r(e,o,a[o]);if(l)for(var o of l(a))n.call(a,o)&&r(e,o,a[o]);return e};import{c as p,f as c}from"./index.8ad7c599.js";import{u as i}from"./useBasicForm.b0a1b532.js";import{_ as d,a as u}from"./index.76f0df78.js";import{t as m}from"./toolbarKeys.efa257c4.js";import{d as f,r as b,o as g,h as y,i as v,c as _,f as w,w as h,b as P,u as V,g as j,E as I}from"./vendor.b96c6562.js";const O=[{field:"channel",component:"Select",label:"支付配置",required:!0,componentProps:{options:[{label:"线下支付",value:"offline"},{label:"微信支付",value:"wechat"}]}},{field:"offline",component:"Input",label:"线下支付内容",required:!0,slot:"offline"}],C=[{field:"appid",component:"Input",label:"支付公众号AppId",required:!0,componentProps:{placeholder:"请输入公众号AppId"}},{field:"mch_id",component:"Input",label:"微信支付商户号",required:!0,componentProps:{placeholder:"请输入微信支付商户号(MCH_ID)"}},{field:"key",component:"Input",label:"微信支付密钥",required:!0,componentProps:{placeholder:"请输入微信支付密钥(API_KEY)"}}];const q={class:"cb-page open"},U={class:"cb-m-b-40"},A={class:"cb-m-l-60"},F=j("确认");var K=d(f({__name:"pay",setup(e){const l=b("7"),t=b([{value:"7",name:"支付配置"},{value:"2",name:"微信支付"}]),{register:n,validate:r,setFieldsValue:d,resetFields:f,setProps:j}=i({options:{labelCol:{span:6},wrapperCol:{span:6}},schemas:O});g((()=>{x()}));const K=e=>{f();j({schemas:{7:O,2:C}[e]}),setTimeout((()=>{x()}),50)},R=async()=>{try{const e=await r(),a={type:l.value,config:s({},e)};e.agreement&&(a.config={agreements:s({},e)});const{err_code:o}=await u().open.openConfig(a);o||I.success("保存成功")}catch(e){}},x=async()=>{try{const{data:n}=await u().open.getConfig({type:l.value});"5"===l.value&&(n.config=(e=s({},n.config),t={admin_logo:n.config.admin_logo,web_logo:n.config.web_logo},a(e,o(t)))),d(s({},n.config))}catch(n){}var e,t},D=async e=>await E(e),E=e=>new Promise(((a,o)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=e=>{a(e.target.result)}}));return(e,a)=>{const o=y("CbTab"),r=y("el-button"),s=y("el-card");return v(),_("div",q,[w(s,{class:"open-main"},{default:h((()=>[P("div",U,[w(o,{tabs:t.value,modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),onChange:K},null,8,["tabs","modelValue"])]),w(V(p),{onRegister:V(n)},{agreement:h((({model:e,field:a})=>[w(V(c),{modelValue:e[a],"onUpdate:modelValue":o=>e[a]=o},null,8,["modelValue","onUpdate:modelValue"])])),offline:h((({model:e,field:a})=>[w(V(c),{modelValue:e[a],"onUpdate:modelValue":o=>e[a]=o,useLibrary:!1,"http-request":D,toolbarKeys:V(m)},null,8,["modelValue","onUpdate:modelValue","toolbarKeys"])])),_:1},8,["onRegister"]),P("div",A,[w(r,{type:"primary",onClick:R},{default:h((()=>[F])),_:1})])])),_:1})])}}}),[["__scopeId","data-v-bb401742"]]);export{K as default};
